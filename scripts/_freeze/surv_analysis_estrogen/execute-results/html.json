{
  "hash": "36626a21358e1e92fc16a06b0fb49195",
  "result": {
    "markdown": "# Estrogen receptor status is continuous, not dichotomous\n\nCurrently in the clinics estrogen receptor (ER) status is treated \nas dichotomous condition. Either a breast cancer (BC) is ER positive (ER+) or\nER negative (ER-). The threshold for ER+ cells usually is 1% or 10% of the \ncells positive in a IHC staining. The idea is that ER+ BC patients\nwill receive endocrine therapy, usually tamoxifen or some aromatase inhibitor,\nfor treatment. The problem is not all patients respond the same to these\ndrugs and they also have different proportions of ER+ cells. \n\nIn this document we show how leveraging molecular information distinguishes\nER+ BC patients and how one should look more carefully on ER status. In order\nto do this, estrogen related signatures: estrogen response early and late from\nMSigDB[@Subramanian2005] and $SET_{ER/PR}$[@Sinn2019], \nare used to calculate scores for each\nBC patient. These scores then are used to calculate associations with survival\nanalysis. When performing cox regression, we try to adjust for sensible \ncovariates in order to reduce bias. Even though we are adjusting, it is \nvery difficult to know if a covariate is missing in the regression. Thus,\ncare should be always taken when interpreting these results.\n\nThis chapter is structure in the following way. First section corresponds\nto loading the datasets and then filtering them. Estrogen signatures scores\nare calculated using GSVA [@Hnzelmann2013]. Given the scores, cox regression\ncan be performed adjusting for clinical variables. After this the Hazard\nratios can be computed and interpreted along with their confidence\nintervals.\n\n## Loading and filtering the datasets\n\nThe preprocessing of the datasets is described in the website below:\n> https://chronchi.github.io/transcriptomics\n\nTo check the code used here either click in the code button on the top right\npart of the page or check the github page \n(github.com/chronchi/molecular_landscape).\n\nThe TCGA, METABRIC and SCANB cohorts are used in this section here. They\nare the biggest cohort of Breast cancer patients in the world. Each datasets\nhas an overall equal distribution of ER+ and ER- patients and similar age\ndistribution. \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n* The library is already synchronized with the lockfile.\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## UMAP projection of the datasets\n\nThe plots below show how each patient is different in a molecular sense, \nand even inside each molecular subtype there are some differences. This\nindicates how different patients, at least molecularly. We only do the umap\nof samples that have a PAM50 molecular subtype assigned.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![UMAP projections of all three cohorts in the following order\":\" TCGA, SCANB and METABRIC. They are colored by the PAM50 molecular subtype.](surv_analysis_estrogen_files/figure-html/fig-surv-umap-all-1.png){#fig-surv-umap-all width=960}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\nFrom the plots above we see a distinction of the different molecular subtypes.\n\n## Calculating scores\n\nIn order to calculate the scores, the package `msigdb` is used to load\nthe hallmark data into R. The $SET_{ER/PR}$ is made of the following genes:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Affy </th>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> is_target </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 202089_s_at </td>\n   <td style=\"text-align:left;\"> SLC39A6 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 203438_at </td>\n   <td style=\"text-align:left;\"> STC2 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 204508_s_at </td>\n   <td style=\"text-align:left;\"> CA12 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 205225_at </td>\n   <td style=\"text-align:left;\"> ESR1 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 205380_at </td>\n   <td style=\"text-align:left;\"> PDZK1 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 205440_s_at </td>\n   <td style=\"text-align:left;\"> NPY1R </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 205831_at </td>\n   <td style=\"text-align:left;\"> CD2 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 206401_s_at </td>\n   <td style=\"text-align:left;\"> MAPT </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 209123_at </td>\n   <td style=\"text-align:left;\"> QDPR </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 209309_at </td>\n   <td style=\"text-align:left;\"> AZGP1 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 209459_s_at </td>\n   <td style=\"text-align:left;\"> ABAT </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 213245_at </td>\n   <td style=\"text-align:left;\"> ADCY1 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 213539_at </td>\n   <td style=\"text-align:left;\"> CD3D </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 214440_at </td>\n   <td style=\"text-align:left;\"> NAT1 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 218398_at </td>\n   <td style=\"text-align:left;\"> MRPS30 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 218976_at </td>\n   <td style=\"text-align:left;\"> DNAJC12 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 219197_s_at </td>\n   <td style=\"text-align:left;\"> SCUBE2 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 222379_at </td>\n   <td style=\"text-align:left;\"> KCNE4 </td>\n   <td style=\"text-align:left;\"> yes </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 200650_s_at </td>\n   <td style=\"text-align:left;\"> LDHA </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 202961_s_at </td>\n   <td style=\"text-align:left;\"> ATP5J2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 211662_s_at </td>\n   <td style=\"text-align:left;\"> VDAC2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 201623_s_at </td>\n   <td style=\"text-align:left;\"> DARS </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 205480_s_at </td>\n   <td style=\"text-align:left;\"> UGP2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 217750_s_at </td>\n   <td style=\"text-align:left;\"> UBE2Z </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 212175_s_at </td>\n   <td style=\"text-align:left;\"> AK2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 212050_at </td>\n   <td style=\"text-align:left;\"> WIPF2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 202631_s_at </td>\n   <td style=\"text-align:left;\"> APPBP2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 202342_s_at </td>\n   <td style=\"text-align:left;\"> TRIM2 </td>\n   <td style=\"text-align:left;\"> no </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe first 18 genes are considered to be the target genes, the last 10 genes\nare the genes used for reference. According to their paper, the score is \ncalculated in the following way:\n\n\n$$\nSET_{ER/PR} = \\sum_{i = 1}^{18} \\frac{T_i}{18} - \\sum_{j=1}^{10}\\frac{R_j}{10} + 2\n$$\n\n\nWhere $T_i$ are the expression levels of target genes and $R_j$ are the\nexpression levels of the reference genes. Here we use GSVA to calculate\nthe scores, even when using their genes. \n\n\n::: {.cell}\n\n:::\n\n\nBefore we calculate any score, let us check the number of genes available\nfor each pathway in each dataset. This is important, in other to have\nrobust scores, most of the genes should be available in the datasets. We also\nadd signatures of 18 and 200 random genes for control. \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> pathway </th>\n   <th style=\"text-align:right;\"> tcga </th>\n   <th style=\"text-align:right;\"> scanb </th>\n   <th style=\"text-align:right;\"> metabric </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:left;\"> average_percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_ADIPOGENESIS </td>\n   <td style=\"text-align:right;\"> 188 </td>\n   <td style=\"text-align:right;\"> 187 </td>\n   <td style=\"text-align:right;\"> 164 </td>\n   <td style=\"text-align:right;\"> 210 </td>\n   <td style=\"text-align:left;\"> 0.86 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_ALLOGRAFT_REJECTION </td>\n   <td style=\"text-align:right;\"> 141 </td>\n   <td style=\"text-align:right;\"> 134 </td>\n   <td style=\"text-align:right;\"> 139 </td>\n   <td style=\"text-align:right;\"> 335 </td>\n   <td style=\"text-align:left;\"> 0.41 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_ANDROGEN_RESPONSE </td>\n   <td style=\"text-align:right;\"> 93 </td>\n   <td style=\"text-align:right;\"> 92 </td>\n   <td style=\"text-align:right;\"> 83 </td>\n   <td style=\"text-align:right;\"> 102 </td>\n   <td style=\"text-align:left;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_ANGIOGENESIS </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:left;\"> 0.81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_APICAL_JUNCTION </td>\n   <td style=\"text-align:right;\"> 155 </td>\n   <td style=\"text-align:right;\"> 148 </td>\n   <td style=\"text-align:right;\"> 151 </td>\n   <td style=\"text-align:right;\"> 231 </td>\n   <td style=\"text-align:left;\"> 0.66 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_APICAL_SURFACE </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:left;\"> 0.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_APOPTOSIS </td>\n   <td style=\"text-align:right;\"> 141 </td>\n   <td style=\"text-align:right;\"> 141 </td>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 183 </td>\n   <td style=\"text-align:left;\"> 0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_BILE_ACID_METABOLISM </td>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 71 </td>\n   <td style=\"text-align:right;\"> 77 </td>\n   <td style=\"text-align:right;\"> 114 </td>\n   <td style=\"text-align:left;\"> 0.65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_CHOLESTEROL_HOMEOSTASIS </td>\n   <td style=\"text-align:right;\"> 67 </td>\n   <td style=\"text-align:right;\"> 67 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 77 </td>\n   <td style=\"text-align:left;\"> 0.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_COAGULATION </td>\n   <td style=\"text-align:right;\"> 92 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 88 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:left;\"> 0.56 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_COMPLEMENT </td>\n   <td style=\"text-align:right;\"> 152 </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:right;\"> 144 </td>\n   <td style=\"text-align:right;\"> 237 </td>\n   <td style=\"text-align:left;\"> 0.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_DNA_REPAIR </td>\n   <td style=\"text-align:right;\"> 145 </td>\n   <td style=\"text-align:right;\"> 144 </td>\n   <td style=\"text-align:right;\"> 127 </td>\n   <td style=\"text-align:right;\"> 170 </td>\n   <td style=\"text-align:left;\"> 0.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_E2F_TARGETS </td>\n   <td style=\"text-align:right;\"> 196 </td>\n   <td style=\"text-align:right;\"> 179 </td>\n   <td style=\"text-align:right;\"> 174 </td>\n   <td style=\"text-align:right;\"> 218 </td>\n   <td style=\"text-align:left;\"> 0.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION </td>\n   <td style=\"text-align:right;\"> 179 </td>\n   <td style=\"text-align:right;\"> 172 </td>\n   <td style=\"text-align:right;\"> 172 </td>\n   <td style=\"text-align:right;\"> 204 </td>\n   <td style=\"text-align:left;\"> 0.85 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_ESTROGEN_RESPONSE_EARLY </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:right;\"> 176 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:right;\"> 216 </td>\n   <td style=\"text-align:left;\"> 0.81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_ESTROGEN_RESPONSE_LATE </td>\n   <td style=\"text-align:right;\"> 176 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:right;\"> 218 </td>\n   <td style=\"text-align:left;\"> 0.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_FATTY_ACID_METABOLISM </td>\n   <td style=\"text-align:right;\"> 128 </td>\n   <td style=\"text-align:right;\"> 124 </td>\n   <td style=\"text-align:right;\"> 127 </td>\n   <td style=\"text-align:right;\"> 165 </td>\n   <td style=\"text-align:left;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_G2M_CHECKPOINT </td>\n   <td style=\"text-align:right;\"> 187 </td>\n   <td style=\"text-align:right;\"> 172 </td>\n   <td style=\"text-align:right;\"> 173 </td>\n   <td style=\"text-align:right;\"> 204 </td>\n   <td style=\"text-align:left;\"> 0.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_GLYCOLYSIS </td>\n   <td style=\"text-align:right;\"> 173 </td>\n   <td style=\"text-align:right;\"> 167 </td>\n   <td style=\"text-align:right;\"> 167 </td>\n   <td style=\"text-align:right;\"> 215 </td>\n   <td style=\"text-align:left;\"> 0.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_HEDGEHOG_SIGNALING </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:left;\"> 0.65 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_HEME_METABOLISM </td>\n   <td style=\"text-align:right;\"> 152 </td>\n   <td style=\"text-align:right;\"> 150 </td>\n   <td style=\"text-align:right;\"> 138 </td>\n   <td style=\"text-align:right;\"> 214 </td>\n   <td style=\"text-align:left;\"> 0.69 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_HYPOXIA </td>\n   <td style=\"text-align:right;\"> 168 </td>\n   <td style=\"text-align:right;\"> 163 </td>\n   <td style=\"text-align:right;\"> 163 </td>\n   <td style=\"text-align:right;\"> 215 </td>\n   <td style=\"text-align:left;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_IL2_STAT5_SIGNALING </td>\n   <td style=\"text-align:right;\"> 163 </td>\n   <td style=\"text-align:right;\"> 156 </td>\n   <td style=\"text-align:right;\"> 163 </td>\n   <td style=\"text-align:right;\"> 216 </td>\n   <td style=\"text-align:left;\"> 0.74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_IL6_JAK_STAT3_SIGNALING </td>\n   <td style=\"text-align:right;\"> 65 </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 103 </td>\n   <td style=\"text-align:left;\"> 0.61 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_INFLAMMATORY_RESPONSE </td>\n   <td style=\"text-align:right;\"> 142 </td>\n   <td style=\"text-align:right;\"> 131 </td>\n   <td style=\"text-align:right;\"> 144 </td>\n   <td style=\"text-align:right;\"> 222 </td>\n   <td style=\"text-align:left;\"> 0.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_INTERFERON_ALPHA_RESPONSE </td>\n   <td style=\"text-align:right;\"> 92 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 81 </td>\n   <td style=\"text-align:right;\"> 140 </td>\n   <td style=\"text-align:left;\"> 0.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_INTERFERON_GAMMA_RESPONSE </td>\n   <td style=\"text-align:right;\"> 178 </td>\n   <td style=\"text-align:right;\"> 176 </td>\n   <td style=\"text-align:right;\"> 164 </td>\n   <td style=\"text-align:right;\"> 286 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_KRAS_SIGNALING_DN </td>\n   <td style=\"text-align:right;\"> 71 </td>\n   <td style=\"text-align:right;\"> 54 </td>\n   <td style=\"text-align:right;\"> 82 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:left;\"> 0.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_KRAS_SIGNALING_UP </td>\n   <td style=\"text-align:right;\"> 156 </td>\n   <td style=\"text-align:right;\"> 147 </td>\n   <td style=\"text-align:right;\"> 146 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:left;\"> 0.68 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_MITOTIC_SPINDLE </td>\n   <td style=\"text-align:right;\"> 194 </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:right;\"> 168 </td>\n   <td style=\"text-align:right;\"> 215 </td>\n   <td style=\"text-align:left;\"> 0.85 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_MTORC1_SIGNALING </td>\n   <td style=\"text-align:right;\"> 190 </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:right;\"> 176 </td>\n   <td style=\"text-align:right;\"> 211 </td>\n   <td style=\"text-align:left;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_MYC_TARGETS_V1 </td>\n   <td style=\"text-align:right;\"> 194 </td>\n   <td style=\"text-align:right;\"> 194 </td>\n   <td style=\"text-align:right;\"> 185 </td>\n   <td style=\"text-align:right;\"> 236 </td>\n   <td style=\"text-align:left;\"> 0.81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_MYC_TARGETS_V2 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:right;\"> 52 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:left;\"> 0.93 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_MYOGENESIS </td>\n   <td style=\"text-align:right;\"> 126 </td>\n   <td style=\"text-align:right;\"> 131 </td>\n   <td style=\"text-align:right;\"> 139 </td>\n   <td style=\"text-align:right;\"> 212 </td>\n   <td style=\"text-align:left;\"> 0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_NOTCH_SIGNALING </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 34 </td>\n   <td style=\"text-align:left;\"> 0.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_OXIDATIVE_PHOSPHORYLATION </td>\n   <td style=\"text-align:right;\"> 199 </td>\n   <td style=\"text-align:right;\"> 185 </td>\n   <td style=\"text-align:right;\"> 169 </td>\n   <td style=\"text-align:right;\"> 220 </td>\n   <td style=\"text-align:left;\"> 0.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_P53_PATHWAY </td>\n   <td style=\"text-align:right;\"> 177 </td>\n   <td style=\"text-align:right;\"> 172 </td>\n   <td style=\"text-align:right;\"> 160 </td>\n   <td style=\"text-align:right;\"> 215 </td>\n   <td style=\"text-align:left;\"> 0.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_PANCREAS_BETA_CELLS </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:left;\"> 0.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_PEROXISOME </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 84 </td>\n   <td style=\"text-align:right;\"> 87 </td>\n   <td style=\"text-align:right;\"> 110 </td>\n   <td style=\"text-align:left;\"> 0.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_PI3K_AKT_MTOR_SIGNALING </td>\n   <td style=\"text-align:right;\"> 91 </td>\n   <td style=\"text-align:right;\"> 91 </td>\n   <td style=\"text-align:right;\"> 84 </td>\n   <td style=\"text-align:right;\"> 118 </td>\n   <td style=\"text-align:left;\"> 0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_PROTEIN_SECRETION </td>\n   <td style=\"text-align:right;\"> 94 </td>\n   <td style=\"text-align:right;\"> 92 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 98 </td>\n   <td style=\"text-align:left;\"> 0.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_REACTIVE_OXYGEN_SPECIES_PATHWAY </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 47 </td>\n   <td style=\"text-align:right;\"> 43 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:left;\"> 0.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_SPERMATOGENESIS </td>\n   <td style=\"text-align:right;\"> 62 </td>\n   <td style=\"text-align:right;\"> 59 </td>\n   <td style=\"text-align:right;\"> 71 </td>\n   <td style=\"text-align:right;\"> 144 </td>\n   <td style=\"text-align:left;\"> 0.44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_TGF_BETA_SIGNALING </td>\n   <td style=\"text-align:right;\"> 49 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:right;\"> 59 </td>\n   <td style=\"text-align:left;\"> 0.81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_TNFA_SIGNALING_VIA_NFKB </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 173 </td>\n   <td style=\"text-align:right;\"> 166 </td>\n   <td style=\"text-align:right;\"> 228 </td>\n   <td style=\"text-align:left;\"> 0.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_UNFOLDED_PROTEIN_RESPONSE </td>\n   <td style=\"text-align:right;\"> 106 </td>\n   <td style=\"text-align:right;\"> 106 </td>\n   <td style=\"text-align:right;\"> 98 </td>\n   <td style=\"text-align:right;\"> 115 </td>\n   <td style=\"text-align:left;\"> 0.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_UV_RESPONSE_DN </td>\n   <td style=\"text-align:right;\"> 129 </td>\n   <td style=\"text-align:right;\"> 131 </td>\n   <td style=\"text-align:right;\"> 121 </td>\n   <td style=\"text-align:right;\"> 152 </td>\n   <td style=\"text-align:left;\"> 0.84 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_UV_RESPONSE_UP </td>\n   <td style=\"text-align:right;\"> 129 </td>\n   <td style=\"text-align:right;\"> 126 </td>\n   <td style=\"text-align:right;\"> 127 </td>\n   <td style=\"text-align:right;\"> 191 </td>\n   <td style=\"text-align:left;\"> 0.67 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_WNT_BETA_CATENIN_SIGNALING </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:left;\"> 0.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HALLMARK_XENOBIOTIC_METABOLISM </td>\n   <td style=\"text-align:right;\"> 142 </td>\n   <td style=\"text-align:right;\"> 135 </td>\n   <td style=\"text-align:right;\"> 141 </td>\n   <td style=\"text-align:right;\"> 224 </td>\n   <td style=\"text-align:left;\"> 0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SET_ERPR </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:left;\"> 0.93 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> random_200 </td>\n   <td style=\"text-align:right;\"> 149 </td>\n   <td style=\"text-align:right;\"> 132 </td>\n   <td style=\"text-align:right;\"> 157 </td>\n   <td style=\"text-align:right;\"> 200 </td>\n   <td style=\"text-align:left;\"> 0.73 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> random_18 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:left;\"> 0.74 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nMost of the genes are available in all datasets. When calculating scores\nit is always good to check the availability of the genes. Otherwise this\ncan make the score unstable, since too many of the genes are missing. \nFor example, \nHALLMARK_PANCREAS_BETA_CELLS might have an unstable score, due to a lot \nof genes missing. \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\nFor each dataset one can plot the differences in scores for ER+ and ER- BC\npatients. This should be already an indication that the scores are meaningful.\nThe next sections shows the results for each dataset individually.\n\n\n::: {.cell}\n\n:::\n\n\n::: {.panel-tabset}\n\n### TCGA\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for TCGA patients](surv_analysis_estrogen_files/figure-html/fig-scores-tcga-1.png){#fig-scores-tcga width=960}\n:::\n:::\n\n\n### METABRIC\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for METABRIC patients](surv_analysis_estrogen_files/figure-html/fig-scores-metabric-1.png){#fig-scores-metabric width=960}\n:::\n:::\n\n\n### SCANB\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for SCANB patients](surv_analysis_estrogen_files/figure-html/fig-scores-scanb-1.png){#fig-scores-scanb width=960}\n:::\n:::\n\n\n:::\n\nFrom the plots above one can conclude that three different estrogen pathways\ncapture the differences between ER status and also molecular subtypes.\nThere are two plots with random genes for control and we can see that\nthere is no difference between the ER status when using those gene sets.\n\nBelow is a combined image for TCGA, SCANB and METABRIC using the $SET_{ER/PR}$\nsignature.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![SET ER/PR scores for all three cohorts.](surv_analysis_estrogen_files/figure-html/fig-scores-metabric-tcga-scanb-1.png){#fig-scores-metabric-tcga-scanb width=576}\n:::\n:::\n\n\n\nAnother way to look at the data is to plot by molecular subtype instead\nof ER status.\n\n::: {.panel-tabset}\n\n### TCGA\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for TCGA patients stratified by PAM50 molecular subtype](surv_analysis_estrogen_files/figure-html/fig-scores-tcga-pam50-1.png){#fig-scores-tcga-pam50 width=960}\n:::\n:::\n\n\n### METABRIC\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for METABRIC patients stratified by PAM50 molecular subtype](surv_analysis_estrogen_files/figure-html/fig-scores-metabric-pam50-1.png){#fig-scores-metabric-pam50 width=960}\n:::\n:::\n\n\n### SCANB\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for SCANB patients stratified by PAM50 molecular subtype](surv_analysis_estrogen_files/figure-html/fig-scores-scanb-pam50-1.png){#fig-scores-scanb-pam50 width=960}\n:::\n:::\n\n\n:::\n\nIn all cohorts the luminal A and B patients have a similar score. Also\nthe distinction is very clear between the basal and HER2-like patients\nversus luminal A and B.\n\nOne question that usually arises when calculating scores from gene sets is\nif proliferation associated genes (PAG) are driving the distinctions. \nThese signatures are highly curated and they have close or no PAGs. \nTherefore, the scores are not affected by PAGs and they really reflect the\nbiology.\n\nLastly we show in @fig-scores-scanb-esr1 the correlation of \nthe estrogen signaling scores with the signatures. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores for SCANB patients stratified by PAM50 molecular subtype](surv_analysis_estrogen_files/figure-html/fig-scores-scanb-esr1-1.png){#fig-scores-scanb-esr1 width=672}\n:::\n:::\n\n\nWe see that there is a positive correlation between signatures and scores,\nthe problem though is the high variability in the scores in this case. \n\nIn the next section we will show how these scores are also prognostic for\nER+ BC patients.\n\n## Survival analysis\n\nSince the scores are continuous variables and they are already scaled due\nto the output of GSVA, cox regression [@Cox1972] can be used. The advantages \nof using cox regression is that one can control for other variables. You might\nask, why should one control for clinical variables? One of the reasons is \nbecause the data being dealt here is observational data. There are several\nconfounders, for example, a score might be up because patients with a higher\ntumor grade have higher expression of some genes. Thus the score is confounded\nby the tumor grade and the interpretation changes. \n\nThere are limitations still when dealing with observational data. A strong \nhypothesis for performing survival analysis with observational data is that\nwe have measured all the confounder variables. This is pretty strong and in\npractice we never know if a confounder is missing or not. For a more\nthorough overview of the causal framework for observational data, check\nthe books [@Gelman2020-uh; @McElreath2020-jn].\n\nAll the cohorts have a different set of clinical variables available. Therefore,\nthe regression will be done by adjusting a different set of variables. Below\nis the description of the variables used for each cohort.^[This [webpage](https://web.archive.org/web/20220630083539/https://www.cancer.net/cancer-types/breast-cancer/stages) explains with more details the different tumor stages and how\nBC are classified.]\n\n- **Age**: age is one of the most important factors to adjust, specially in\nbreast cancer. This covariate is used for all cohorts.\n- **NPI**: the Nottingham prognostic index scores each tumor\nbased on tumor grade, tumor size and number of lymph nodes. Only METABRIC\nhas this information. \n- **Tumor Size**: as name describes. Only SCANB has this information. \n- **Tumor Stage**: tumors are usually described in terms of stage, it reflects\nthe tumor size and location. SCANB and TCGA have this information.\n- **Node Stage**: similar to tumor stage, but encodes the number of lymph nodes\nwhere breast cancer cells can be found. SCANB and TCGA have this information.\n\nThus the models we are going to use for the survival analysis of each dataset\nis shown below.\n\n- TCGA: `~ score + age + node_stage + tumor_stage`,\n- SCANB: `~ score + age + node_stage + tumor_stage`,\n- METABRIC: `~ score + age + NPI`,\n\nwhere score is one of the scores calculated earlier with GSVA. Note here\nthat since each node stage and tumor stage have sub classifications they \nwill be grouped together, otherwise there will be too many variables with\nfew points. We will also subselect specific tumor stages for TCGA and SCANB,\nsince there are very few patients with tumor stage 4.\n\nTo be very specific in the survival analysis, only endocrine treated patients\nshould be used in the analysis, as that is what are interested in. METABRIC\nand SCANB has this kind of annotation, but TCGA not. So the survival analysis\non SCANB and METABRIC will be performed on endocrine only treated, ER+ BC\npatients. On TCGA, to mitigate this effect, we subselect only luminal A and \nB patients, and we keep in mind that they might have been treated with\nchemotherapy as well. Moreover, in Sweden the guidelines for BC treatment is to\nuse 10% as the threshold for ER status. Therefore, ER+ BC patients used on\nSCANB are those that are above the 10% threshold.\n\nThe table below shows the number of patients for each cohort.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> cohort </th>\n   <th style=\"text-align:right;\"> number_patients </th>\n   <th style=\"text-align:right;\"> nb_events </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> TCGA </td>\n   <td style=\"text-align:right;\"> 684 </td>\n   <td style=\"text-align:right;\"> 73 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SCANB </td>\n   <td style=\"text-align:right;\"> 1021 </td>\n   <td style=\"text-align:right;\"> 253 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> METABRIC </td>\n   <td style=\"text-align:right;\"> 938 </td>\n   <td style=\"text-align:right;\"> 576 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SCANB High ER </td>\n   <td style=\"text-align:right;\"> 800 </td>\n   <td style=\"text-align:right;\"> 173 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n### Results\n\nThe table below shows the results for each analysis performed for a specific\nterm. In order to understand the table the user can filter based on the term,\ncohort and type of analysis. Since METABRIC has recurrence free survival (RFS)\nand overall survival (OS), the results for both analysis are presented here. \n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-67df6cefb78cf04a6a0e\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-67df6cefb78cf04a6a0e\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"-2.27148265520376\\\" data-max=\\\"1.77954244489716\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.004592471636845\\\" data-max=\\\"1.67042024260416\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"-4.90595579479006\\\" data-max=\\\"12.1646114627659\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"0.966214769567373\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.103159117239438\\\" data-max=\\\"5.92714380316058\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\"],[\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\"],[\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\"],[\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"ER.pct\",\"ER.pct\",\"ER.pct\",\"ER.pct\",\"ER.pct\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"random_200\",\"random_200\",\"random_200\",\"random_18\",\"random_18\",\"random_18\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_200\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"random_18\",\"ER.pct\",\"ER.pct\",\"ER.pct\",\"ER.pct\",\"ER.pct\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"SET_ERPR\",\"SET_ERPR\",\"SET_ERPR\",\"random_200\",\"random_200\",\"random_200\",\"random_18\",\"random_18\",\"random_18\"],[\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"SET_ERPR\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"random_200\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"random_18\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"SET_ERPR\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"random_200\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"random_18\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"ER.pct\",\"age\",\"npi\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"age\",\"npi\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"age\",\"npi\",\"SET_ERPR\",\"age\",\"npi\",\"random_200\",\"age\",\"npi\",\"random_18\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"SET_ERPR\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"random_200\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"random_18\",\"age\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"ER.pct\",\"age\",\"npi\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY\",\"age\",\"npi\",\"HALLMARK_ESTROGEN_RESPONSE_LATE\",\"age\",\"npi\",\"SET_ERPR\",\"age\",\"npi\",\"random_200\",\"age\",\"npi\",\"random_18\"],[0.0567152337524123,0.476200705597867,1.09466101517939,0.824240143237846,0.276215858435805,0.265666942198468,-1.45316423474658,0.0543516491298734,0.487664887426536,1.14067956714181,0.912130694798677,0.276274392756463,0.199016757637233,-2.27148265520376,0.0598999745222749,0.491249760541679,1.08950853606705,0.921117875079167,0.32765013562628,0.343683673490105,-1.46820338127532,0.060752781414116,0.417076229482115,1.00903003042635,0.770664241829956,0.370510126591169,0.509880203737392,1.4597841340713,0.0625557787208527,0.391088292864188,0.9773391140849,0.660658099323493,0.368933830682551,0.458646838672897,1.08097117706613,0.0967313034439939,0.597333832295021,0.36702148122908,0.540671706064782,-1.53617220307938,0.0978936775553507,0.576361701386289,0.398344736009967,0.526669716924458,-0.499406339037604,0.0998824171591504,0.609638177390687,0.392727588781084,0.365418423655436,-0.968292395757463,0.0984831824605779,0.56453040417547,0.418199535034726,0.53148884368704,-0.265641584309006,0.0963274058125246,0.553403166685602,0.420977553092133,0.62225668510788,-0.576654119297092,0.0940840826124767,0.632484624957371,0.315445160874618,0.505093604901068,-0.0223045253563687,0.055693069494223,0.219265759722507,-0.551169549172122,0.054826688758258,0.223450055554535,-0.629299270717519,0.0565713643382181,0.205555729610991,-0.490383719893686,0.0526190435815749,0.230569575411248,-1.47150734807333,0.0544630240119934,0.221882829861002,0.253049751597136,0.0287598105871422,1.17275541438921,0.593496780820495,1.02781598327561,-2.02836007747051,0.0301561314325823,1.18628298421262,0.619606110427015,0.993926525993947,-1.35242036385813,0.0355526665338399,1.21550820290209,0.59351336959758,0.626620393660499,-1.59134829607344,0.0300293799665104,1.13628095341736,0.646037554260586,1.10396387683291,1.77954244489716,0.0310623883980441,1.15527777133652,0.666527158153425,1.06427940624748,-0.021602393691707,0.0280938836655422,1.38435799337238,0.671232940092598,1.00325303577303,-0.0165129387905744,0.0084513346796223,0.374671517290816,-0.821463905760239,0.00723289466324552,0.381582696925001,-0.957640347848426,0.00970318542227921,0.356895688193783,-0.800099496288017,0.0048478291981742,0.392592251532688,-1.75657400464595,0.00643962229165783,0.383911211007806,0.437173022010678],[0.010886554098736,0.336308315475216,0.581772588932351,0.706394279596297,0.383952215910169,0.554979764556066,0.737296332838902,0.0109480240355903,0.337299024443268,0.587824947442621,0.711413855912346,0.384106656681585,0.558764016198543,0.859143019111638,0.0105804953292004,0.337921019941039,0.582593873549099,0.708764448198166,0.38489129431499,0.551452484417036,0.39763624663053,0.0106214608295797,0.334803211782351,0.580673537317869,0.703408355025827,0.383918213933488,0.557061665998696,1.67042024260416,0.0106991722545802,0.336275361154794,0.587110203249268,0.707607726186834,0.383396165370496,0.550360153880606,0.532070471193557,0.00872113812505374,0.146775527181124,0.144591731442603,0.250422401648354,0.383272692233587,0.00867806440530656,0.147256083706027,0.145012061065301,0.250585600563391,0.454852338650116,0.00873713833736188,0.148536049683592,0.144595321847289,0.254519963004808,0.199711231701049,0.00868545684346425,0.146857494910355,0.144708533599157,0.250573969158813,0.706710087838806,0.00871894530960338,0.146133888289253,0.144278456366944,0.252167969540886,0.270905734737117,0.00975825761152342,0.16427978260058,0.16427884909116,0.279926759698549,0.00459247163684595,0.00463957429423414,0.0402818721583936,0.23919750023664,0.00461849132027626,0.0401220485404947,0.294401791614505,0.00465048674274348,0.0406772539486767,0.134888824759695,0.00466295305155512,0.0401470265712973,0.528858931495537,0.00462208695727682,0.0400521390319824,0.171401573086126,0.014419438838108,0.267653135305838,0.285127291182859,0.423818113919206,0.719281205899439,0.0142853867933313,0.270439453888795,0.28617026969134,0.42727935947263,0.834667837216252,0.0141101366869919,0.269653562913581,0.286226465691246,0.440981445085367,0.361087206450136,0.0144097506548769,0.268706900653163,0.284468895252214,0.424970279033363,1.3009642594459,0.0143880988214256,0.270380396454567,0.284368656140354,0.438835554858264,0.510017655969782,0.0153488615482966,0.291673433105824,0.313373604513237,0.456709874190238,0.0093552734759438,0.00531885515593636,0.0525211562522489,0.290943030742163,0.00531061218557182,0.052139205814295,0.358864592260281,0.00535322011280186,0.0531385067902819,0.163087383938048,0.00538399963204837,0.0522155541795588,0.653944417516172,0.00534239417087574,0.0520387451274007,0.216695625405128],[5.20965892770396,1.41596470763733,1.88159606692415,1.16682731874457,0.719401652054613,0.478696628535597,-1.97093647428203,4.9645167888913,1.44579394568797,1.94050894250818,1.28213793872334,0.719264787398588,0.35617318200125,-2.64389351327384,5.6613582501153,1.45374135242428,1.87009954195,1.29961072034701,0.851279674198437,0.623233520932321,-3.69232783408581,5.71981409985769,1.2457354493757,1.7376890207311,1.09561428482273,0.965075667536208,0.91530298144512,0.873902325199031,5.84678676372121,1.16300014226782,1.66466041413685,0.933650206002775,0.962278353321637,0.833357639427499,2.03163158940443,11.0915917231156,4.06971001070158,2.53832966496271,2.15903889790179,-4.00803979570545,11.2805889635354,3.91400943771465,2.74697658307598,2.10175571038538,-1.09795266859507,11.4319372433456,4.10431123413692,2.71604629917318,1.43571615892673,-4.84846238997171,11.3388603772392,3.8440694124605,2.88994383837197,2.12108562382306,-0.375884806061515,11.0480571206733,3.78695984322414,2.91781298256657,2.46762777303082,-2.12861540142984,9.64148379331304,3.85004542217562,1.92018122003993,1.80437770738675,-4.85675843426376,12.0039180239954,5.44328622215783,-2.30424460383928,11.8711252130227,5.56925839240261,-2.13755244921041,12.1646114627659,5.05333348879315,-3.63546587915867,11.2844892495811,5.74312956905485,-2.78241939473749,11.7832105962976,5.53984968652548,1.4763560627882,1.99451663202975,4.38162404878667,2.08151516593994,2.42513462619851,-2.81998203322178,2.11097759331654,4.38650118225879,2.16516590313632,2.32617491100132,-1.62030966518209,2.51965429694355,4.50766602068461,2.07357963270177,1.42096770883227,-4.40710240531104,2.0839624977374,4.22870030749239,2.27103055920332,2.59774372773547,1.36786420685769,2.15889456859918,4.27278673485726,2.34388405248309,2.42523513526889,-0.0423561683381936,1.83035618486377,4.74626015345769,2.14195749235237,2.19669661741348,-1.7650941827661,1.58893867793895,7.13372560747409,-2.82345276896572,1.36197003480997,7.31853680863666,-2.66852837672505,1.81258853882632,6.71632888749244,-4.90595579479006,0.900414102801456,7.51868399562786,-2.68612126290154,1.2053813488274,7.37741100535608,2.0174519960583],[1.8918809239639e-07,0.156785837767849,0.0598908806554443,0.24328011221383,0.471893479242516,0.632154464640894,0.0487311424674724,6.88723286247422e-07,0.148235004742027,0.0523178684532471,0.199794262294553,0.471977787602689,0.721710874415636,0.00819584358466826,1.50179531285201e-08,0.146018028736397,0.0614699960909584,0.193734423545292,0.394614013062295,0.533131076698918,0.000222210765540212,1.06640664429937e-08,0.212861534682797,0.0822656243496042,0.273247607669262,0.334506913384205,0.360032594366149,0.382171448331038,5.01159261755998e-09,0.244829444700585,0.0959805248782993,0.350484358271185,0.335909799578203,0.404643057712898,0.0421909662313425,1.37813459114956e-28,4.70716916618619e-05,0.0111383008596912,0.0308471493202163,6.12248052258228e-05,1.63646672020973e-29,9.07760850532161e-05,0.00601474287515046,0.0355746806612294,0.272225157686272,2.8957533631057e-30,4.05521227094964e-05,0.00660666781846244,0.151083125263371,1.24422113989055e-06,8.42342209604802e-30,0.000121010753657552,0.00385310656715613,0.0339145975276665,0.707002536615661,2.24010393055241e-28,0.000152501734644652,0.00352495694855983,0.0136011670454345,0.0332860932169905,5.34102893627151e-22,0.000118095921765314,0.0548350129204502,0.071172115346195,1.19323015918265e-06,3.38866560979539e-33,5.23064983567251e-08,0.0212089166682267,1.67203484996365e-32,2.55825861234783e-08,0.0325530845446077,4.79722447594097e-34,4.3416483739151e-07,0.000277478720564909,1.56548219173772e-29,9.29425533480135e-09,0.0053955266131008,4.7643110014363e-32,3.02731376976364e-08,0.139848331215884,0.0460956242066939,1.17797944140544e-05,0.0373867774034434,0.0153027108217613,0.00480263384141262,0.0347742378348291,1.15188539175178e-05,0.0303749824946733,0.0200092215261229,0.105165773748254,0.0117470142619949,6.55446400578388e-06,0.0381183683794466,0.155326147187144,1.04762665121272e-05,0.0371635786585333,2.35045194610084e-05,0.0231451280709058,0.00938384988479396,0.171354585380703,0.0308583473459092,1.93045072624989e-05,0.019084103117562,0.0152984744983528,0.966214769567373,0.0671966949729576,2.07212169312235e-06,0.0321969027692903,0.0280421206133261,0.0775479381923473,0.112074237880521,9.76879808607063e-13,0.00475094254205767,0.173207342005352,2.50689263039449e-13,0.00761843427011816,0.0698953068368757,1.86359914655505e-11,9.29734644466914e-07,0.367899918465636,5.53303377639483e-14,0.00722868485821742,0.228056118282138,1.61397182637281e-13,0.0436483657768711],[1.05835438387297,1.60994610873037,2.98816956756282,2.2801475213913,1.31813236331054,1.30430057885417,0.233829225703695,1.05585582766376,1.62850902467106,3.12889393637955,2.48962150973089,1.31820952155115,1.22020241343794,0.103159117239438,1.06173034114924,1.63435749964834,2.97281268326916,2.5120970315747,1.3877033793748,1.41013250265652,0.230338944922228,1.06263617829863,1.51751818815168,2.74293915674045,2.16120133744214,1.44847333099062,1.66509171123352,4.30503011871023,1.06455383671313,1.47858905651281,2.6573758520763,1.9360660389945,1.4461919069773,1.58193192694063,2.94754074545091,1.10156434730583,1.81726719655895,1.44342892540956,1.71715990160983,0.215203281311791,1.10284552164282,1.77955209636922,1.48935737653706,1.69328379390169,0.606890840189767,1.10504097657907,1.83976560954673,1.48101488930156,1.44111687940522,0.379730914908699,1.10349584615345,1.75862174735613,1.51922378253109,1.70146363716962,0.766713880545467,1.10111951791385,1.73916161506353,1.52345008128133,1.86312779405181,0.561774857212008,1.09865211957403,1.88228153775687,1.37086943258138,1.65714062968594,0.977942381449306,1.05727312455574,1.2451621466662,0.576275433642648,1.05635752017624,1.25038318902194,0.532965134465039,1.05820213000036,1.22820742657673,0.61239136234565,1.05402802988208,1.25931708174158,0.229579168525067,1.05597343003096,1.24842509115278,1.2879473526785,1.02917736727807,3.23088280582935,1.81030760946855,2.79495493565189,0.131551077928448,1.03061543285648,3.27488575402844,1.85819597366021,2.70182244783781,0.258613563611819,1.0361922193436,3.37200729284297,1.81033764050702,1.87127570536714,0.20365084490778,1.03048480911795,3.11516136484869,1.90796562050515,3.01609780047426,5.92714380316058,1.03154985862219,3.17490519271471,1.94746233452755,2.89874941056787,0.978629266875321,1.02849223851026,3.9922620232121,1.95664826414805,2.72713889485448,0.983622652420833,1.00848714802766,1.45451355358533,0.439787375766714,1.00725911522458,1.46460077518394,0.383797446802063,1.0097504139581,1.42888681231551,0.449284259777188,1.00485959893368,1.48081446638426,0.172635299564733,1.0064604012382,1.46801509231471,1.54832394800455]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>type_analysis<\\/th>\\n      <th>cohort<\\/th>\\n      <th>score<\\/th>\\n      <th>term<\\/th>\\n      <th>estimate<\\/th>\\n      <th>std.error<\\/th>\\n      <th>statistic<\\/th>\\n      <th>p.value<\\/th>\\n      <th>HR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"scrollX\":true,\"columnDefs\":[{\"targets\":8,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":6,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":7,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":9,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[5,6,7,8,9]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\",\"options.columnDefs.4.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nThe table above shows that $SET_{ER/PR}$ had a small hazard ratio (< 1) in all\n4 analysis performed. Moreover, for all cases where a measure of estrogen\nsignaling was used, the hazard ratio was below 1, indicating that the higher\nthe score, the less likely the patient is to suffer the event in a specific\ntimepoint. This indicates that ER signaling is actually something continuous\nand not dichotomous.\n\n@fig-forest-plot shows the forest plot of HALLMARK_ESTROGEN_RESPONSE_EARLY for all \nthree cohorts. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![Forest plots of the different cohorts and their hazard ratios. The bars correspond to 95% confidence interval.](surv_analysis_estrogen_files/figure-html/fig-forest-plot-1.png){#fig-forest-plot width=576}\n:::\n:::\n\n\nThe hazard ratios are all below 1 and small for HALLMARK_ESTROGEN_RESPONSE_EARLY.\nThe variability changes depending on the cohort, \nspecially because they have different follow-up times, \nSCANB being the shortest. TCGA has very few number of events and we could\nnot select based on the treatment, the results for TCGA are less reliable.\n\n## Comparison of ER IHC and molecular ER signaling\n\nThe new released dataset from the SCANB consortium contains the ER \npercentage based on the IHC stainings. This is great, because we can\nnow compare the molecular ER signaling score to what is seen in the clinics.\n\nFirst we start by comparing the molecular score with the percentages \n(@fig-cor-ihc-rna).\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Correlation between ER IHC percentage and molecular ER signaling by using the signature HALLMARK_ESTROGEN_RESPONSE_EARLY and SET ER/PR.](surv_analysis_estrogen_files/figure-html/fig-cor-ihc-rna-1.png){#fig-cor-ihc-rna width=768}\n:::\n:::\n\n\nThe first thing that one can notice is that ER percentage is very discrete,\npathologists probably don't assign non rounded percentage values, which \nmakes sense. Another thing to notice is that for high ER percentage \npatients you have a whole spectrum of molecular ER signaling score.\n\n@fig-er-hist shows the distribution of the ER IHC percentage for the\npatients used in the previous survival analysis for SCANB. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![Histogram of ER IHC percentage of the SCANB samples used for survival analysis](surv_analysis_estrogen_files/figure-html/fig-er-hist-1.png){#fig-er-hist width=672}\n:::\n:::\n\n\nWe see that the majority of the patients actually have already pretty\nhigh percentage. It could be that the results of the overall survival \nanalysis are actually driven by the the low ER percentage patients,\nso we performed the survival analysis only on patients with ER percentage\nequal or higher than 90%. The table below shows the total number of \npatients for each analysis.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> cohort </th>\n   <th style=\"text-align:right;\"> number_patients </th>\n   <th style=\"text-align:right;\"> nb_events </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> TCGA </td>\n   <td style=\"text-align:right;\"> 684 </td>\n   <td style=\"text-align:right;\"> 73 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SCANB </td>\n   <td style=\"text-align:right;\"> 1021 </td>\n   <td style=\"text-align:right;\"> 253 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> METABRIC </td>\n   <td style=\"text-align:right;\"> 938 </td>\n   <td style=\"text-align:right;\"> 576 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SCANB High ER </td>\n   <td style=\"text-align:right;\"> 800 </td>\n   <td style=\"text-align:right;\"> 173 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThere was a decrease of around 200 patients with 80 events less, so indeed\na lot of those patients with lower ER percentage had died. @fig-er-ihc-survival\nshows the results of the survival analysis when considering the ER IHC \npercentage as a continuous score on SCANB.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Survival analysis using ER IHC percentage as the score instead of the common molecular ER signaling scores](surv_analysis_estrogen_files/figure-html/fig-er-ihc-survival-1.png){#fig-er-ihc-survival width=672}\n:::\n:::\n\n\nWe a very tight confidence interval in this case with a HR very close\nto 1, meaning that for every 1% increase there is a 2% decrease in your \nrisk of dying. The table with the values is shown below.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n  type_analysis cohort  score   term    estimate   std.error statistic\n1            os  scanb ER.pct ER.pct -0.02230453 0.004592472 -4.856758\n2           rfs  scanb ER.pct ER.pct -0.01651294 0.009355273 -1.765094\n       p.value        HR\n1 1.193230e-06 0.9779424\n2 7.754794e-02 0.9836227\n```\n:::\n:::\n\n\nNext we selected only patients that had 90% or more ER IHC percentage \nto perform the survival analysis. @fig-er-ihc-high-os shows the results\nfor both the analysis done on ER IHC percentage,  \nHALLMARK_ESTROGEN_RESPONSE_EARLY and SET_ERPR.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Survival analysis using ER IHC percentage, HALLMARK_ESTROGEN_RESPONSE_EARLY and SET_ERPR as the scores. Only patients with 90% or more in the ER IHC were selected.](surv_analysis_estrogen_files/figure-html/fig-er-ihc-high-os-1.png){#fig-er-ihc-high-os width=576}\n:::\n:::\n\n\nWhen performing the survival analysis among the high ER percentage, there is\nno evidence to differentiate between 90 to 100%, but by using the molecular\nscores that fact is still true, showing that perhaps the molecular score\ncould be more sensitive for these patients. \n\nWe can also analyse the recurrence free survival for this cohort \n(@fig-er-ihc-high-rfs).\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Survival analysis using ER IHC percentage, HALLMARK_ESTROGEN_RESPONSE_EARLY and SET_ERPR as the scores. Only patients with 90% or more in the ER IHC were selected.](surv_analysis_estrogen_files/figure-html/fig-er-ihc-high-rfs-1.png){#fig-er-ihc-high-rfs width=576}\n:::\n:::\n\n\nThe problem now is that the number of events is much smaller, so the\nconfidence intervals for the estimates will be bigger. We see\nthat for both signatures the HR is way below 1, meaning that \nthe higher the score the better it is for the patient. \n\n## Conclusion\n\nIn this chapter we've shown that ER+ BC patients are very distinct\nfrom each other, as it can be seen from the umap projections and \nthe subtypes. These patients might respond differently for endocrine therapy\nas well, and this might depend on the ER signaling, how active it is. \nTherefore, when deciding a treatment, more care should be taken with\nER+ BC patients and check their signaling scores somehow. The $SET_{ER/PR}$\nsignature is a good signature showing very good hazard ratios across\nthe different cohorts. This signature has also been validated on the clinics\nfor use.\n\nKnowing the ER signaling for a patient is very important when deciding\ntreatment, but not enough. What could be other alternatives for patients\nthat have low ER signaling and are still considered ER+? Should they use\nonly endocrine therapy or supplement it with something else? In the\nnext chapters we present a framework where we can take a look\nat a more personalised approach for treatments. \n\n",
    "supporting": [
      "surv_analysis_estrogen_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.22/datatables.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js\"></script>\n<link href=\"site_libs/nouislider-7.0.10/jquery.nouislider.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/nouislider-7.0.10/jquery.nouislider.min.js\"></script>\n<link href=\"site_libs/selectize-0.12.0/selectize.bootstrap3.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/selectize-0.12.0/selectize.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}