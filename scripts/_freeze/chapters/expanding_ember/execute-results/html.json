{
  "hash": "db2bd594e14dcc66ab6c819887944e1e",
  "result": {
    "markdown": "# Expanding embedding and removing batch effects \n\nWe have used some numbers of genes for doing the embedding. Here we try to \nperform the embedding with all the genes (~10000 genes) and then\nwe try to regress out the components. \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n* The library is already synchronized with the lockfile.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n    ../../results/plots/expanding_ember ../../results/rds_files/expanding_ember \n                                  FALSE                                    TRUE \n   ../../results/tables/expanding_ember \n                                  FALSE \n```\n:::\n:::\n\n\n## Embedding with more than 1000 genes\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nTotal number of stable genes: 39\nTotal number of genes: 8248\nNumber of samples: 1005\nTotal number of stable genes: 39\nTotal number of genes: 8248\nNumber of samples: 7216\nTotal number of stable genes: 39\nTotal number of genes: 8248\nNumber of samples: 1868\nTotal number of stable genes: 39\nTotal number of genes: 8248\nNumber of samples: 426\n```\n:::\n:::\n\n\nAnd now we can visualize the results.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![PCA projections colored by different factors and organized by different components. (A) Plot of the first two components colored by cohort. (B) Plot of the first two components colored by ER status. (C) Plot of the second and third components colored by cohort. (D) Plot of the second and third components colored by ER status. (E) Plot of the second and third components colored by PAM50. (F) Plot of the second and third components colored by INTCLUST, only METABRIC has an assigned value for this variable, NAs are TCGA samples.](expanding_ember_files/figure-html/fig-pca-embeddings-1-1.png){#fig-pca-embeddings-1 width=1344}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\nAnd now we can visualize the results.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![PCA projections colored by different factors and organized by different components. (A) Plot of the first two components colored by cohort. (B) Plot of the first two components colored by ER status. (C) Plot of the second and third components colored by cohort. (D) Plot of the second and third components colored by ER status. (E) Plot of the second and third components colored by PAM50. (F) Plot of the second and third components colored by INTCLUST, only METABRIC has an assigned value for this variable, NAs are TCGA samples.](expanding_ember_files/figure-html/fig-pca-embeddings-2-1.png){#fig-pca-embeddings-2 width=1344}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![PCA embedding colored by cohort. The components used are the first and second components.](expanding_ember_files/figure-html/fig-pca-scanb-pc1-1.png){#fig-pca-scanb-pc1 width=672}\n:::\n:::\n\n\n@fig-pca-scanb-er-pam50-all-genes shows that the SCANB samples are also well mixed\nregarding the clinical factors, including the $SET_{ER/PR}$ signature.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![PCA embedding of all samples from TCGA, SCANB and METABRIC. (A) Colored by cohort, (B) colored by ER status, (C) colored by PAM50 molecular subtype, (D) colored by the $SET_{ER/PR}$ signature and only SCANB samples.](expanding_ember_files/figure-html/fig-pca-scanb-er-pam50-all-genes-1.png){#fig-pca-scanb-er-pam50-all-genes width=1536}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-11-1.png){width=1152}\n:::\n:::\n\n\nLet us also check the other components in the biplots.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-12-1.png){width=1536}\n:::\n:::\n\n\nWe see that the pam50 subtypes are being separated using the components 3, 4\nand also 8. In the component 8 there is some expression that is able \nto differentiate between HER2-like from all other samples.\n\nWe now plot by cohort.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-13-1.png){width=1536}\n:::\n:::\n\n\nIn PC1, 2 and 5 there are some small differences in the differences of the \ndistributions from the datasets. We will then remove these 3 components\nup to component 10 with exception of components 3, 4 and 5.\n\n## Removing the batch effects\n\nWe now try to remove the batch effects by removing all the PCs that are not\nof interest, so we remove the first two components and the fifth as well. We\nthen calculate the scores for each cohort separately and then compare\nto what was calculated before. We can then try to calculate the scores\nusing samples coming from all cohorts.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nIn general it looks good, the luminal B population is a bit compressed \ntowards the luminal A population though.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-17-1.png){width=576}\n:::\n:::\n\n\nThere is a very good merging of the datasets. We see mostly\ngreen points because they are the majority. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\nNow we see that the first loadings has a tail in a similar fashio as the\nother loadings. \n\nWe now try to calculate the scores of the samples using these new embeddings\nonly from TCGA samples as we will compare the results later on. \n\n\n::: {.cell}\n\n:::\n\n\nAnd we can now check and compare the scores.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n\nWe see that for the three pathways the correlation is positive and\nstrong. The difference is that it is a bit noisy, so the correlation\nis not perfect. What is interesting to see is that at the extremes\nthe scores have less variation usually. \n\nWe now calculate the scores from SCANB and compare the results. Remember\nthat SCANB was not used for the PCA training.\n\n\n::: {.cell}\n\n:::\n\n\nAnd we can now check and compare the scores.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n\nThe same phenomenon happened. Samples in the endges have lower variability,\nbut samples in the middle are the ones that have high variability.\nFor example there are several samples from the regressed data\nwith SET_ERPR score close to 0.25 and negative scores.\n\nWhat happens now if we use another dataset and then use only one sample to \ncalculate the score. Let us include SCANB samples in the pipeline. For this \nwe select 50 scanb samples and 100 random samples from tcga and metabric.\nWe then combine all these samples together and calculate the GSVA scores.\n\n\n::: {.cell}\n\n:::\n\n\nWe now plot only the scores from the SCANB samples.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\nSo it seems there are still dataset related problems there when calculating\nthe scores. The scores are positively correlated, but they are not quite\nthe same as only using the SCANB dataset. Moreover, for G2M checkpoint the \nscores are concentrated around -0.4 from the regressed data but \nthey are in a range going from - 0.4 to 0.1 in the unregressed data. \n\nIf we try to instead add some samples from the SCANB dataset as well \nrandomly into the mix. How well does the scores get compared to the \n\"ground truth\"? \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-26-1.png){width=960}\n:::\n:::\n\n\nIt does not work so well when including some SCANB samples together \nwith the METABRIC and TCGA samples. We are trying to achieve a\ncorrelation of almost 1 with very low variability since we want to use\nthe scores clinically. \n\nLet us check the distribution of some genes for SCANB and TCGA after\nregressing out the first two PCs.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-27-1.png){width=960}\n:::\n:::\n\n\nWe see that even though the expression profile of the samples are \noverlapping there are discrepancies. That is why when using GSVA \nit does not work so well perhaps.\n\n## Scoring strategy with regressed data\n\nWe now try to use a slightly different scoring strategy. We can think of \nour data in a log scale, so what we do now instead is to sum all of \nour genes of interest and then subtract an average of the housekeeping\ngenes expression levels.\n\nFirst we check the distribution of this average for each cohort\nseparately.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Distribution of the average of the housekeeping genes for distinct cohorts.](expanding_ember_files/figure-html/fig-hkg-regressed-1.png){#fig-hkg-regressed width=768}\n:::\n:::\n\n\nIndeed the tcga and metabric cohorts have an overlapping \ndistribution, but the SCANB does not overlap completely, it is\nactually shifted. One should still take into account that \nthe distributions are very close to 0, meaning that the \nhousekeeping genes have very close to 0 values, as expected here in this case.\nWe now calculate the score by taking this into account. \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores obtained from regressed data of all the four cohorts TCGA, SCANB, METABRIC and POETIC compared to the original GSVA scores.](expanding_ember_files/figure-html/fig-scores-regressed-1.png){#fig-scores-regressed width=1344}\n:::\n:::\n\n\nThe scores are actually highly correlated, specially the estrogen related \npathways. Also the correlation between the scores in general follows the \nsame trends.\n\nThe plot below is a subset of the scores above to include in the \npublication.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores obtained from regressed data of all the four cohorts TCGA, SCANB, METABRIC and POETIC compared to the original GSVA scores.](expanding_ember_files/figure-html/fig-scores-regressed-subset-1.png){#fig-scores-regressed-subset width=768}\n:::\n:::\n\n\nWe now compare the distributions\nof these scores across the different cohorts and pathways of interest.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-34-1.png){width=1536}\n:::\n:::\n\n\nAnd with all molecular subtypes together.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-35-1.png){width=960}\n:::\n:::\n\n\nWe see that the overlap is actually pretty good in general, even for \nSCANB. The only part where there is a bigger discrepancy is for\nG2M checkpoint. We see below that by calculating the GSVA score \non the whole scanb cohort we don't have this problem.\n\nAnd as a comparison we plot with the original scores using GSVA on the \nwhole cohort individually.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-36-1.png){width=1536}\n:::\n:::\n\n\nAnd all the subtypes together for the original score:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-37-1.png){width=960}\n:::\n:::\n\n\nWe see that by doing GSVA the distributions they overlap much more than \nusing the regressed data and the simple sum of the values for those genes.\nStill for estrogen signaling it seems that the estrogen early signature\nis pretty robust.\n\n### Checking the patients from POETIC with new scores\n\nWe now use the new scores to evaluate the comparison with the neighboorhood,\njust as before in the previous chapter where we used the POETIC trial data.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"treated_nb63_baseline\"\n[1] \"treated_nb236_baseline\"\n```\n:::\n:::\n\n\nPatient 63 @fig-pt63 is considered a responder. According to \nthe scores, when comparing the estrogen early signature to its average \ndistribution in the neighborhood, the score is higher.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Posterior distribution of the average scores in the neighborhood of patient 63 from POETIC trial. Each dot corresponds to a 1% quantile.](expanding_ember_files/figure-html/fig-pt63-1.png){#fig-pt63 width=960}\n:::\n:::\n\n\nPatient 236 @fig-pt236 was considered a non responder. According to \nthe scores, when comparing the estrogen early signature to its average \ndistribution in the neighborhood, the score is lower, being in the\n5% quantile.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Posterior distribution of the average scores in the neighborhood of patient 236 from POETIC trial. Each dot corresponds to a 1% quantile.](expanding_ember_files/figure-html/fig-pt236-1.png){#fig-pt236 width=960}\n:::\n:::\n\n\nWhen comparing these two patients, there is also a difference in the androgen\nresponse score, which could be a reflection of different estrogen signaling.\n\nIt reflects what we saw previously as well. \n\n### Responder vs non responder comparison of new scores\n\nWe now compare the scores for responders and non responders.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-41-1.png){width=768}\n:::\n:::\n\n\nThe higher E2F targets in average the lower the estrogen early score is\nfor non responders, whereas this correlation does not exist for responder\npatients. This difference is mostly drive by the high E2F target non responder\ntumors. \n\nNow the plot below shows the correlation for baselien Ki67% and E2F targets\nfor the score calculated in the regressed data in a single sample manner. \nWe see a positive correlation between the two scores. Moreover, it is interesting\nto see that when the tumor has low Ki67, there is still a spectrum on \nthe E2F targets score. Also there is no difference in the correlation \nbetween responders and non responders.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-42-1.png){width=768}\n:::\n:::\n\n\nAnd lastly we compare the estrogen signaling signatures between\nresponders and non-responder.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-43-1.png){width=960}\n:::\n:::\n\n\nWe see that the estrogen response early has a wider range when compared to the\nSET ER/PR score. That makes sense as this signature has over 100 genes,\nwhereas SET ER/PR has only 18. Also the responder\nwas very good in discriminating the responders and non responders.\nWhat we can conclude from this figure is that the samples\nwith very low scores are usually non responders, which reflect\ntheir position in the molecular landscape, also in general \nresponders have higher ER signaling than non responders.\n\nBelow is the figure with the GSVA scores before regressing the data, \nwe see that SET ER/PR is not able to really distinguish \ncompletely the non-responders with very low score similar\nto what was done with GSVA. Even estrogen early had\nsome differences.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-44-1.png){width=960}\n:::\n:::\n\n\nAnd below is a figure with both GSVA and regressed scores together.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Comparing scoring strategies for responders and non responders in the POETIC dataset.](expanding_ember_files/figure-html/fig-comparison-scoring-strategy-poetic-1.png){#fig-comparison-scoring-strategy-poetic width=960}\n:::\n:::\n\n\n\nBelow we show the correlation between\nthese scores for all cohorts.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-46-1.png){width=576}\n:::\n:::\n\n\nThese scores are highly correlated but in different absolute\nscales. We now check the change in Ki67 for all patients and \ncompare the scores with the original ones obtained with GSVA.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Comparison of original GSVA and regressed scores between responders and non responders compared to change in Ki67.](expanding_ember_files/figure-html/fig-comparison-og-regressed-er-1.png){#fig-comparison-og-regressed-er width=1152}\n:::\n:::\n\n\nWe see that the bigger the change the higher the score is when using the\nregressed data. Also the non responders tend to have scores mostly in\nthe negative scale, whereas the responders are more shifted to the\nright. SET ER/PR is also a good measure here. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\nThere is a very good match between the two scores in general,\nmeaning that the regression scoring strategy capture relatively\nwell the scores. There is one patient that is a non-responder\nand has a low regressed estrogen early but a GSVA score \nclose to 0, let us check this patient.\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-4ae39b6aede5654482e0\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4ae39b6aede5654482e0\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\"],[\"80\"],[43.24122479462285],[-5.649422739144427],[26.83238127635096],[\"pos\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>patient_nb<\\/th>\\n      <th>ki67<\\/th>\\n      <th>PC3<\\/th>\\n      <th>change_ki67<\\/th>\\n      <th>er_status<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nIt is a patient that is far to the left on the molecular landscape, among the\nbasal like, and had an increase in Ki67 upon ET. So the \nnew scoring system was able to capture this patient as with low score. \n\n### Survival analysis with the new scores\n\nWe can check how robust these scores are by performing survival analysis.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![Overall survival analysis from SCANB and METABRIC cohorts and their scores. The formulas used were the same as for the estrogen signaling analysis. Coefficients were scaled before performing cox regression](expanding_ember_files/figure-html/fig-pca-mol-land-survival-regressed-1.png){#fig-pca-mol-land-survival-regressed width=864}\n:::\n:::\n\n\nThe plot with TCGA is shown below.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-52-1.png){width=432}\n:::\n:::\n\n\n\nScores for TCGA are noisier than SCANB and METABRIC. Though the\nscaled scores they have comparable hazard ratios and also \nthey follow what we saw previously. The only pathway that is \na bit different is the PI3K AKT MTOR signaling. This pathway had a noisier\ncorrelation with the GSVA score as well.\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-52bb2d1b022e30491dca\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-52bb2d1b022e30491dca\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"-0.398255102696566\\\" data-max=\\\"1.25129356321115\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.00461050175932\\\" data-max=\\\"0.715250026338379\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"-6.76436087805681\\\" data-max=\\\"17.6290977009835\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"0.999099322836264\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.671490706720718\\\" data-max=\\\"3.49486085817101\\\" data-scale=\\\"15\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\"],[\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"os\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\",\"rfs\"],[\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"tcga\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"scanb\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\",\"metabric\"],[\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_G2M_CHECKPOINT_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_DNA_REPAIR_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"SET_ERPR_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\"],[\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_G2M_CHECKPOINT_new\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_DNA_REPAIR_new\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"SET_ERPR_new\",\"age\",\"node_stageN1\",\"node_stageN2\",\"node_stageN3\",\"tumor_stagestage_ii\",\"tumor_stagestage_iii\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_G2M_CHECKPOINT_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_DNA_REPAIR_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"SET_ERPR_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"age\",\"npi\",\"HALLMARK_G2M_CHECKPOINT_new\",\"age\",\"npi\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"age\",\"npi\",\"HALLMARK_DNA_REPAIR_new\",\"age\",\"npi\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"age\",\"npi\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"age\",\"npi\",\"SET_ERPR_new\",\"age\",\"npi\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_G2M_CHECKPOINT_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_DNA_REPAIR_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"SET_ERPR_new\",\"age\",\"node_stageN1\",\"node_stageN2and3\",\"tumor_stageT2\",\"tumor_stageT3\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\",\"age\",\"npi\",\"HALLMARK_G2M_CHECKPOINT_new\",\"age\",\"npi\",\"HALLMARK_EPITHELIAL_MESENCHYMAL_TRANSITION_new\",\"age\",\"npi\",\"HALLMARK_DNA_REPAIR_new\",\"age\",\"npi\",\"HALLMARK_ANDROGEN_RESPONSE_new\",\"age\",\"npi\",\"HALLMARK_PI3K_AKT_MTOR_SIGNALING_new\",\"age\",\"npi\",\"SET_ERPR_new\",\"age\",\"npi\",\"HALLMARK_ESTROGEN_RESPONSE_EARLY_new\"],[0.0616377905840081,0.474306853167729,0.954042639241222,0.828955528976151,0.30423497669931,0.470034536811477,0.176153627760754,0.0618675885495185,0.387304547107589,1.01057220491273,0.690761668617657,0.399214859008978,0.505444029834159,0.130498921140544,0.0601662507909038,0.424311209876691,1.06766923308836,0.770167322699961,0.352492428430478,0.426883159333406,-0.0338415059102302,0.0606752369775765,0.427607873754539,1.07795451161204,0.764714585857082,0.357347071371586,0.429233939684253,0.049712265012628,0.062044296894465,0.491664232773412,1.17924009070085,0.937849378395496,0.395316611048624,0.403186797666766,0.180676610064079,0.0602291166978039,0.518466022382417,1.25129356321115,1.07208088242748,0.34162015562071,0.27266068577286,-0.398117441380964,0.0589267518980507,0.467215038072016,1.11839404761123,0.804951179735225,0.305224671782702,0.311986948544274,-0.153544815154153,0.0877546231962248,-0.00443048343256998,0.691749196715961,0.309124689172904,0.389256224976618,0.142924159656714,0.0909298696370283,0.0103778572918325,0.7099569643393771,0.353628557025232,0.402227020135157,0.0478910973264077,0.08822808043915779,0.0127461156425051,0.7311100029615339,0.323352005450829,0.380623469988135,0.0672133035593898,0.0901203101680311,0.0160285949029942,0.722822320956058,0.344403532933293,0.380981879247321,0.0216952214364992,0.08983741147324339,0.0135514064667183,0.715618434507387,0.339117875993968,0.386686328221643,0.0263567156502282,0.0899037945364161,0.0145799982530732,0.74544209198291,0.315132975551969,0.266770731378847,-0.189260056065385,0.08913234708588751,0.00442766686563733,0.733525548164808,0.322892628936288,0.406519586043661,-0.184846429087069,0.054796369073002,0.202884212883009,0.138193421517684,0.0545592933637651,0.226835099658034,4.73645807183829e-05,0.0545304687923254,0.225142427190362,0.0386085632262308,0.0538741584736043,0.228117685319517,0.0753258460397767,0.0543577423173955,0.21678892012922,0.0706450532302673,0.0553708476647072,0.214201716505237,-0.110047770769172,0.0551303773965216,0.221920253020793,-0.0843760067281521,0.0100627540567237,-0.127547982709042,1.16608745987939,0.734981661365082,1.03928630273352,0.341652474701783,0.0184001067077129,-0.141121299365367,1.16163588112556,0.849272110899908,0.98983392765093,0.165946725281887,0.0117416403950703,-0.110722062541095,1.23483040087918,0.775645315118437,0.968301109321701,0.14309699524062,0.0158250406458957,-0.125448460472345,1.20079283782718,0.8296158554936049,0.903381651078438,0.10430578486252,0.0148848685352247,-0.126313336346132,1.19306744975332,0.813340101325531,0.9529000081060059,0.0296628107181683,0.0144877737893204,-0.100932996230727,1.22973600362814,0.748424974574284,0.550319607017098,-0.398255102696566,0.0124810207453315,-0.105858755761456,1.21450697812095,0.768130700526372,0.934845017584215,-0.393978953395248,0.00713162732398492,0.335264730640554,0.285024422145762,0.00652840395830359,0.387769631918236,-0.0366441667297294,0.00663490084222653,0.37902119548141,0.139357411564226,0.00679052209098185,0.389871556151544,0.0607663626894693,0.0062291951380722,0.364100093398194,0.160537500194618,0.00776535216371423,0.371156901929141,-0.167246703185582,0.00771620673845139,0.378896708435262,-0.140954313892214],[0.0107199609781805,0.335128183823087,0.578836969575005,0.702473698806618,0.381934926386708,0.546724758918736,0.11858917411011,0.0106774977627038,0.337790951312884,0.580766851712013,0.707499557020563,0.386181403323284,0.553657907855745,0.121832192810099,0.0106341833842427,0.335078152263452,0.584765710377114,0.704332724224953,0.383469397907644,0.548503811543298,0.118901210661966,0.0107541130417584,0.334489329458643,0.585016015133896,0.704430579347454,0.383428076457855,0.548189339236448,0.121919705507839,0.0107978538970555,0.336667367342697,0.587149821419122,0.7136754478413621,0.383627093791693,0.547675690885109,0.118373797632042,0.0106619183004573,0.337155354245839,0.585851656364178,0.715250026338379,0.383824429425781,0.5510361276590729,0.11779764876355,0.0107832047430927,0.336449903237397,0.582968452237609,0.705280115745491,0.3835387564148,0.556022213499862,0.121921444471585,0.00513403870814099,0.102884644781799,0.14298806203984,0.0943708565437784,0.214050552593927,0.0399740615505735,0.00518302029841512,0.102598935411182,0.142994633856377,0.0943420027599613,0.214590054804199,0.0423542520548911,0.0051897740326235,0.102638844743173,0.142845341582877,0.0946587184244726,0.214138996515675,0.0421907249548449,0.00512914505098728,0.102687809280195,0.142807205543512,0.0939313711730355,0.21456945849856,0.0441160726286537,0.00509597331621979,0.102603947836456,0.143003527556099,0.0939706024274093,0.214349793568774,0.0415244429644247,0.00511253128948482,0.102540887055447,0.143536104884207,0.0938395147307023,0.216358070043775,0.0374531875895836,0.00511167984216038,0.102744052140275,0.14309255214418,0.09392947927132581,0.214444276124612,0.041031612449989,0.00463386455279242,0.0412516999447976,0.0441404039142059,0.00463807368630181,0.0402023404400431,0.0419589406500783,0.00461050175932014,0.0403485209901898,0.0402709518825079,0.00461992468633567,0.0399836142696403,0.0413240652523271,0.00462302074761757,0.0404172999464367,0.0379513142015799,0.00462680207492856,0.0404985121965301,0.0424577930714206,0.00461787453257413,0.0403665074484356,0.0426547700562495,0.0075667479508169,0.193878643012837,0.243959091568216,0.17048667439544,0.358439742322712,0.0701625364399097,0.00765501126281157,0.193018818654386,0.245944649558463,0.169718587872003,0.3604396516307,0.08133158495080239,0.00762699338191024,0.193380695615835,0.24574856765051,0.170423860878981,0.359884195118012,0.0748798456196226,0.00753575849277249,0.192970638099287,0.245779026718092,0.169204200291695,0.363077904994236,0.0786083781600346,0.00746914460777838,0.193032099431133,0.246369565583424,0.168948883007663,0.360837137066073,0.0739430373478525,0.00760254813151414,0.19307130030412,0.247283470832396,0.169517825192695,0.370995637272675,0.0588754961297943,0.00766291759829686,0.193969614194822,0.245949572845819,0.169132536726326,0.359516258248299,0.0635073274552802,0.00537611783369784,0.0543011581473659,0.0552141810825526,0.00540647443675992,0.052402044606779,0.0547038606792418,0.0053169540899735,0.0529000920904637,0.0511748995122641,0.00530446621124086,0.0522270257240905,0.0537943842840951,0.00535108171458861,0.0529017981884821,0.0481135255001357,0.00532367835040025,0.0527370313787425,0.0509516572264319,0.00531027131001208,0.0526262124769372,0.0516056047307676],[5.74981482763476,1.41529980485949,1.64820612605601,1.18005205089444,0.796562334787033,0.859727914537966,1.48541069690893,5.79420290450636,1.14658058660915,1.74006522915988,0.976342192391762,1.03374956839851,0.912917566357333,1.07113660298271,5.65781580182788,1.26630520972636,1.8258068387762,1.09347087847928,0.919219187642643,0.778268355387187,-0.284618682365152,5.64204939468029,1.278390178983,1.84260684105429,1.0855783497722,0.931979407123214,0.783003077517188,0.407745940703833,5.7459841081369,1.46038577083992,2.00841428828278,1.3141118714847,1.03047104192093,0.736178005299391,1.52632266327807,5.6489943929903,1.537765946331,2.13585393097075,1.49888967906208,0.890042762863711,0.494814535902,-3.37967222232159,5.4646789430384,1.38866153200333,1.9184469473751,1.14132124494164,0.7958118095700339,0.561105187831405,-1.25937496737859,17.092707746257,-0.0430626304048216,4.837810841322,3.27563720934865,1.81852473754212,3.57542251431951,17.5437996383756,0.101149756089003,4.96492032737712,3.74836813592972,1.87439730374348,1.13072702274003,17.0003703214333,0.124184130037696,5.11819282911199,3.415977004895,1.77745985636144,1.59308245192102,17.5702401223152,0.156090533193268,5.06152555961765,3.66654429326759,1.77556434132436,0.491775902608519,17.6290977009835,0.132074903085779,5.0042012720746,3.60876558449149,1.80399673721904,0.634727735488441,17.5849866623458,0.14218716720472,5.19341173835163,3.35821190525471,1.23300568971091,-5.05324294795195,17.4369971982081,0.0430941429056381,5.12623149963605,3.43760693065887,1.89568867675179,-4.50497599411593,11.825198697269,4.91820247782529,3.13076930121178,11.7633519978136,5.64233567437028,0.00112883166220486,11.8274477787785,5.57994250260381,0.958719906568705,11.6612633606231,5.70527926217835,1.82280822517903,11.7580571848846,5.36376552655722,1.86146526718504,11.9674122143127,5.28912557245967,-2.59193337213865,11.938474509785,5.49763323726421,-1.97811420895914,1.32986510481525,-0.657875363304437,4.77984834417752,4.31107981882684,2.89947285420663,4.8694430395114,2.40366814312887,-0.73112715303711,4.72315979717797,5.00400175106574,2.74618489717412,2.0403724504111,1.53948480182496,-0.5725600592576831,5.02477150806954,4.55127181791304,2.69059081353706,1.91102150460525,2.09999307449587,-0.650090924235837,4.88566031797533,4.90304527939266,2.48812069986131,1.32690417108173,1.99284781817232,-0.654364412542674,4.84259265923545,4.81411943569133,2.64080359314989,0.401157590790119,1.90564709867019,-0.522775762486402,4.97298100632707,4.41502227699966,1.48335870217423,-6.76436087805681,1.62875570371597,-0.54574916901743,4.9380324757966,4.54159037281683,2.60028578996438,-6.20367710596348,1.32653850689124,6.17417274472657,5.16215973066072,1.20751592089577,7.39989507714881,-0.669864361943189,1.24787627087816,7.16484944550288,2.72315945692924,1.28015182311688,7.46493890368544,1.12960420493995,1.16410017082894,6.88256554344246,3.33663971878688,1.45864412772616,7.03788006692294,-3.28245855561338,1.45307203492656,7.19977157013359,-2.73137607102153],[8.93412441127214e-09,0.156980612204637,0.0993103801666517,0.237979513539687,0.425705259648727,0.389939043486953,0.137435063773138,6.86464254171465e-09,0.251555003694479,0.0818475648797358,0.328894917910836,0.301253253593842,0.361285897987581,0.284108012208059,1.53311544401343e-08,0.205403832497456,0.0678793628322899,0.274187108351987,0.357980936922057,0.436410826761087,0.775936296543184,1.68037872360329e-08,0.201111885155347,0.06538643437351491,0.277665582620934,0.351347167889808,0.433625304834179,0.683460205661326,9.1387890172828e-09,0.144184081198564,0.0445992858111635,0.188808559690152,0.302788939172516,0.461622375768815,0.126929527217093,1.61389119169928e-08,0.124105852729266,0.0326913216465551,0.133902254314543,0.373442924786211,0.620731042723669,0.00072572323229897,4.63745365109287e-08,0.164935696889028,0.0550543630238187,0.253736264399819,0.426141426546249,0.574725831769763,0.20789492675888,1.6818001688998e-65,0.965651608266851,1.31276984489884e-06,0.00105423890168865,0.0689839693135163,0.000349662730068857,6.63397088903683e-69,0.919431580902718,6.87292790917023e-07,0.000177988874615348,0.0608756848540035,0.25817000393558,8.160279379587779e-65,0.901169487362546,3.08477131604852e-07,0.000635536134665469,0.0754926100798111,0.11114169542842,4.16406220081448e-69,0.875961660318148,4.1591496756996e-07,0.000245850351009487,0.0758047517698371,0.62287777348636,1.47298977698312e-69,0.894925046428713,5.60941247747605e-07,0.000307657448718158,0.07123181844745841,0.525606001290211,3.21057007486975e-69,0.8869321678884849,2.06474850656216e-07,0.00078448448774135,0.217573641405566,4.34370792729119e-07,4.32193306241412e-68,0.965626488248,2.95599109590522e-07,0.0005868789467009449,0.058001223489763,6.6380446183486e-06,2.89217570995343e-32,8.73425432634149e-07,0.00174349063497393,6.02921635622353e-32,1.67758622936334e-08,0.999099322836264,2.81573448532543e-32,2.40598104270752e-08,0.337699867316002,2.0103708442477e-31,1.16152494628369e-08,0.0683324415411018,6.41944523059606e-32,8.15046920263831e-08,0.0626785011218377,5.2645065594342e-33,1.22902496189732e-07,0.00954382531051436,7.45784405744468e-33,3.84922462436636e-08,0.0479158239830879,0.183562720476315,0.510618222733792,1.75427473174065e-06,1.62459244568604e-05,0.00373790710467898,1.11913236744137e-06,0.0162315005917338,0.464701490395904,2.32208249625826e-06,5.61522463953328e-07,0.00602927731015427,0.041313243695926,0.123685985419331,0.566942609571334,5.04032267685885e-07,5.33226063273654e-06,0.00713256192849929,0.0560018174044757,0.0357294503472146,0.515633491317331,1.03082787424326e-06,9.43622222326352e-07,0.0128420140821225,0.184540384426316,0.0462781137680327,0.512877056334737,1.2815583993527e-06,1.47850366659441e-06,0.00827096522031644,0.688304102089076,0.0566960070908614,0.6011303082609319,6.593112296805769e-07,1.00999588874723e-05,0.137979133564037,1.338989527249e-11,0.103364745381315,0.585238368432073,7.8914703199388e-07,5.58314429839566e-06,0.00931461517868535,5.51589007825469e-10,0.184661389115186,6.65107902803796e-10,2.44116845876432e-07,0.227233517465319,1.36292143302698e-13,0.502944259891563,0.212076371760296,7.78720866905022e-13,0.00646608401487375,0.200491745687089,8.3338272195096e-14,0.258643038377729,0.244383419432687,5.87841028298878e-12,0.000847977942838704,0.144663081444803,1.95186573461213e-12,0.00102906111367971,0.146203754592135,6.03135167910549e-13,0.00630704564046907],[1.06357703733371,1.60689999373656,2.59618390819077,2.29092468576945,1.35558755015702,1.60004945286942,1.19262126431184,1.06382147325741,1.47300502238927,2.74717251097207,1.9952346622603,1.49065386461438,1.65772143483858,1.13939671064398,1.06201309238607,1.52853721564951,2.90859234261705,2.16012766194083,1.42260888432578,1.53247359602665,0.966724712649293,1.06255377996974,1.53358460427492,2.93866239934253,2.14838110878918,1.42953193337302,1.53608034251781,1.05096865241433,1.06400947599961,1.63503503584894,3.25190211307095,2.55448178292098,1.48485423776325,1.49658642440693,1.19802768654417,1.06207985890091,1.67944943489955,3.49486085817101,2.92145237822941,1.40722566922191,1.31345449540746,0.671583151377701,1.06069754381279,1.59554446933606,3.05993614350592,2.23658730537014,1.35692983260613,1.36613686283834,0.857662327068153,1.09172020634455,0.995579316680731,1.99720598576046,1.36223221552254,1.47588266089071,1.1536423057197,1.09519219633893,1.01043189401953,2.03390372637275,1.42422606944959,1.49515072346963,1.0490564040563,1.09223721156377,1.01282769360675,2.07738523212742,1.38175164942303,1.46319656425477,1.06952358703349,1.09430593191629,1.01615774192272,2.06023967053956,1.41114796530604,1.4637210814417,1.02193227395154,1.09399639798189,1.01364364294908,2.04545126883409,1.40370879903094,1.47209466429462,1.02670712565892,1.0940690232244,1.01468680487644,2.107372881729,1.37044153406055,1.30574104656115,0.82757126378165,1.09322533193932,1.00443748346544,2.08240931556766,1.38111705093734,1.50158255113923,0.831231927096632,1.05632549223425,1.22493062885004,1.14819761492273,1.05607509280198,1.25462296312575,1.00004736570244,1.05604465232874,1.25250109370036,1.03936355889443,1.05535178671868,1.25623315693384,1.07823543239527,1.05586226121092,1.24208189597942,1.07320022930094,1.05693250295605,1.23887253062788,0.895791341632985,1.05667837267022,1.24847181203866,0.919085608743697,1.01011355381851,0.880251177984729,3.20941109201453,2.08544374796282,2.8271985302811,1.40727115019735,1.01857043173356,0.868383970884347,3.19515589838428,2.33794446813288,2.69078756982864,1.18051020869939,1.01181084404421,0.895187520500652,3.4377954241787,2.17199329514789,2.633466684804,1.1538417133931,1.01595091973895,0.8821012263360301,3.32275028079856,2.29243794365612,2.46793471001074,1.10993980581968,1.01499619988921,0.881338648082434,3.29717964412726,2.25542878023671,2.59321912177573,1.03010713430226,1.01459323024498,0.903993601835389,3.42032646331402,2.11366831220859,1.73380706622847,0.671490706720718,1.0125592337387,0.899551695597624,3.36863284515142,2.15573277492802,2.54681871503369,0.674368249253086,1.00715711793862,1.39831051186587,1.32979450416012,1.0065497604367,1.47369025398425,0.964019104396056,1.00665696055784,1.46085399891907,1.14953488365072,1.00681362996134,1.47679109696834,1.06265061035117,1.00624863692203,1.43921826319545,1.17414180286117,1.00779558070526,1.44941047084562,0.845990876946212,1.0077460533799,1.46067215283886,0.868528990500351]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>type_analysis<\\/th>\\n      <th>cohort<\\/th>\\n      <th>score<\\/th>\\n      <th>term<\\/th>\\n      <th>estimate<\\/th>\\n      <th>std.error<\\/th>\\n      <th>statistic<\\/th>\\n      <th>p.value<\\/th>\\n      <th>HR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"scrollX\":true,\"columnDefs\":[{\"targets\":8,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatSignif(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":5,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":6,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":7,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":9,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 2, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[5,6,7,8,9]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\",\"options.columnDefs.4.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n## Regressing the PDXs\n\nWe can use the regressing strategy to score the PDXs and then evaluate\ntheir scores. \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nTotal number of stable genes: 39\nTotal number of genes: 8205\nNumber of samples: 76\n[1] \"Normalization done.\"\n```\n:::\n:::\n\n\nWe start by comparing the scores across the different \ncontrol samples and their positions in the molecular landscape.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Embedding of only regressed PDX control samples on top of the METABRIC, SCANB and TCGA samples](expanding_ember_files/figure-html/fig-pca-pdx-control-only-regressed-1.png){#fig-pca-pdx-control-only-regressed width=864}\n:::\n:::\n\n\nThe results are jus twhat we got previously as well, meaning that\nby using all these genes the information of the PDXs are still \ncaptured. The main differences is that the luminal B region is more\ncompact compare to @fig-pca-pdx-control-only.\n\nAnd now that we have the results we can compare the PDXs as well. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![Scores obtained from the regressed data of the PDXs.](expanding_ember_files/figure-html/fig-pdx-regressed-scores-1.png){#fig-pdx-regressed-scores width=960}\n:::\n:::\n\n\nThe random 200 is just a gene set with 200 random genes that works as a \ncontrol and serves as a comparison to the other pathways.\n\nAnd below we show the distribution of some of the scores calculated \nfor all the other cohorts as a comparison. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-57-1.png){width=768}\n:::\n:::\n\n\nWe see that METS15 is the one with the highest proliferation and\nlowest EMT, it is a PDX that comes from a pleural efusion. Also\nit is the PDX with the lowest apoptosis and highest DNA repair,\nprobably due to a higher replication rate. Moreover, all these\nPDXs they have a estrogen response early scores higher than 0\nin average, which is about the average of the scores in the\nER+ BC samples.\n\nNow we check what happens with some of the PDXs when they\nare treated with P4, to compare with @fig-pdx-p4-control-pathways.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Comparison of position in the molecular landscape between CTRL, E2 and P4 treated samples with the regressed data](expanding_ember_files/figure-html/fig-pdx-p4-control-pathways-regressed.-1.png){#fig-pdx-p4-control-pathways-regressed. width=1248}\n:::\n:::\n\n\nThe results are very similar to what was seen previously using the GSVA. What is \ninteresting here is that we have an absolute scale, so we can compare the scores.\n\n## singscore\n\nWe can try to use singscore instead, it is a sample dependent measure so \nit does not estimate the distribution of the gene expression levels before\ncalculating the enrichment score.\n\n\n::: {.cell}\n\n:::\n\n\nWe start by comparing with the GSVA scores.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/fig-all-pathways-gsva-singscores-1.png){#fig-all-pathways-gsva-singscores width=1920}\n:::\n:::\n\n\nWe see that in all cases there is a correlation, but the interpretation\nchanges. In some of the pathways there is difference in the singscores\nbased on the cohort, this is not seen on GSVA. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/fig-selected-pathways-gsva-singscores-1.png){#fig-selected-pathways-gsva-singscores width=1152}\n:::\n:::\n\n\nThe next figure shows the same comparison but instead of using \nsingscore, we used ssGSEA.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Calculating ranks...\"\n[1] \"Calculating absolute values from ranks...\"\n[1] \"Calculating ranks...\"\n[1] \"Calculating absolute values from ranks...\"\n[1] \"Calculating ranks...\"\n[1] \"Calculating absolute values from ranks...\"\n[1] \"Calculating ranks...\"\n[1] \"Calculating absolute values from ranks...\"\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-63-1.png){width=1152}\n:::\n:::\n\n\nThe picture is similar as before, but now we actually look at the distributions\nacross the 3 big cohorts. We used ssGSEA without the normalization, as that\nwould be necessary in the case of an individual sample. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/fig-ssgsea-dists-1.png){#fig-ssgsea-dists width=1152}\n:::\n:::\n\n\nWe see that overall there is a discrepancy, sometimes big,\ndepending on the pathway, including the random genes\npathway. Next we show the same distribution for \nsingscore. Similarly there is a big discrepancy in several cases. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/fig-singscore-dists-1.png){#fig-singscore-dists width=960}\n:::\n:::\n\n\nBut now, @fig-regressed-scores-dists shows that when we calculate\nthe scores with the regressed data using our methodology the distributions\nare matched and adjusted, with the expection of G2M, which seems to be \nsomething more fundamental instead of batch effect. Note that \nall the distributions are overlapping significantly.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/fig-regressed-scores-dists-1.png){#fig-regressed-scores-dists width=960}\n:::\n:::\n\n\nThe next two figures are the distributions of the singscore and GSVA\nfilled by cohort.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-67-1.png){width=1920}\n:::\n:::\n\n\nFor several pathways in the singscore the distributions are similar,\nbut that is not always the case.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-68-1.png){width=1920}\n:::\n:::\n\n\nOn the other hand GSVA gives very similar distributions for all the \ndifferent cohorts. Therefore we actually need to use GSVA. It is important in \nthe end to calculate scores based on the cohort. \n\nWe now move on and try the same analysis on the regressed data.\n\n\n::: {.cell}\n\n:::\n\n\nWe start by comparing with the GSVA scores.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-70-1.png){width=1920}\n:::\n:::\n\n\nWe see that in all cases there is a correlation, but the interpretation\nchanges. In some of the pathways there is difference in the singscores\nbased on the cohort, this is not seen on GSVA. \n\nThe next two figures are the distributions of the singscore and GSVA\nfilled by cohort.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](expanding_ember_files/figure-html/unnamed-chunk-71-1.png){width=1920}\n:::\n:::\n\n\nIn the end the best way of scoring seems to be using GSVA on the \nunregressed data though it depends on the pathways. For example the\nhallmark estrogen response early and set ER/PR pathways seem to \nhave been regressed quite well, so we can actually compare the results using \nthe scores. On the other hand we can't use the pathways G2M checkpoint,\nE2F targets and EMT. For the PI3K signaling score it seems it is \ncomparable to SCANB only.",
    "supporting": [
      "expanding_ember_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.28/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/nouislider-7.0.10/jquery.nouislider.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/nouislider-7.0.10/jquery.nouislider.min.js\"></script>\n<link href=\"../site_libs/selectize-0.12.0/selectize.bootstrap3.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/selectize-0.12.0/selectize.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}